/*! brackets2 */
;var map={39:Array(39,39,0),34:Array(34,34,1),91:Array(91,93,0),93:Array(91,93,0),123:Array(123,125,1),125:Array(123,125,1),40:Array(40,41,1),41:Array(40,41,1),60:Array(60,62,1),62:Array(60,62,1),96:Array(96,96,0)};var pos={LEFT:0,RIGHT:1,MODIFIER:2};var keymap={8:"BACKSPACE",9:"TAB",39:"RIGHT",37:"LEFT"};var tab=new function(){this.LENGTH=4;this.STR=Array(this.LENGTH+1).join(" ")};function getSelectionText(){var a="";if(window.getSelection){a=window.getSelection().toString()}else{if(document.selection&&document.selection.type!="Control"){a=document.selection.createRange().text}}return a}function doGetCaretPosition(c){var b=0;if(document.selection){c.focus();var a=document.selection.createRange();a.moveStart("character",-c.value.length);b=a.text.length}else{if(c.selectionStart||c.selectionStart=="0"){b=c.selectionStart}}return(b)}function setCaretPosition(b,c){if(b.setSelectionRange){b.focus();b.setSelectionRange(c,c)}else{if(b.createTextRange){var a=b.createTextRange();a.collapse(true);a.moveEnd("character",c);a.moveStart("character",c);a.select()}}}function typeInTextarea(c,e){var f=c.selectionStart;var b=c.selectionEnd;if(!document.queryCommandSupported("insertText")){console.log("insertText queryCommand not supported!");return}var d=document.createEvent("TextEvent");if(e==""){e=" "}d.initTextEvent("textInput",false,true,null,e,9,"en-US");c.focus();c.setSelectionRange(f,b);c.dispatchEvent(d);if(e!=" "){var a=map[e[0].charCodeAt(0)];if(f==b&&e.length==2&&e[0]==String.fromCharCode(a[pos.LEFT])&&e[1]==String.fromCharCode(a[pos.RIGHT])){c.selectionStart=f+1;c.selectionEnd=b+1}else{if(a!==undefined&&e[0]==String.fromCharCode(a[pos.LEFT])&&e[e.length-1]==String.fromCharCode(a[pos.RIGHT])){c.selectionStart=f+1;c.selectionEnd=f+e.length-1}else{setCaretPosition(c,f+e.length)}}c.focus()}else{}}var brackets2=function(d,e){var b=e.shiftKey;var a=map[e.which];var h=getSelectionText();var f=doGetCaretPosition(d);if(a==undefined){return true}if(a[pos.MODIFIER]==1){if(!b){return true}}else{if(b){return true}}if(h==""){var g=d.value.substring(f-1,f);var c=d.value.substring(f,f+1);if((g==""||g==" ")&&(c==""||c==" ")){d.selectionStart=f;d.selectionEnd=f;typeInTextarea(d,String.fromCharCode(a[pos.LEFT])+String.fromCharCode(a[pos.RIGHT]));return false}return true}h=String.fromCharCode(a[pos.LEFT])+h+String.fromCharCode(a[pos.RIGHT]);typeInTextarea(d,h);return false};var brackets3=function(b,a){var h=doGetCaretPosition(b);var f=keymap[a.which];if(f=="BACKSPACE"){var g=map[b.value.substring(h-1,h).charCodeAt(0)];if(g!==undefined){var c=b.value.substring(h-2,h-1);var d=b.value.substring(h-1,h-0);var i=b.value.substring(h+0,h+1);var e=b.value.substring(h+1,h+2);if(d==String.fromCharCode(g[pos.LEFT])&&i==String.fromCharCode(g[pos.RIGHT])&&(c==""||c==" ")&&(e==""||e==" ")){b.selectionStart=h-1;b.selectionEnd=h+1;b.setSelectionRange(h-1,h+1);typeInTextarea(b,"")}}}else{if(f=="TAB"){if(getSelectionText()==""){b.selectionStart=h;b.selectionEnd=h}typeInTextarea(b,tab.STR);return false}}return true};[].forEach.call(document.querySelectorAll("textarea,input"),function(a){if(typeof a.addEventListener!="undefined"){a.addEventListener("keypress",function(b){if(!brackets2(this,b)){b.preventDefault();b.stopPropagation();return false}return true});a.addEventListener("keydown",function(b){if(!brackets3(this,b)){b.preventDefault();b.stopPropagation();return false}return true})}});